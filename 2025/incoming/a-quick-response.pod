Author: Ludo Tolhurst-Cleaver <camel@ltcdev.com>
Title: A Quick Response
Topic: Imager::QRCode

=encoding utf8

Cautiocus smiled as he checked over the Workshop Safety Questionnaire one last time. In all his years as Assistant Head of the Elf & Safety Directorate at the North Pole's busy Toy Workshops, no-one had so much as caught their thumb with a hammer in the run-up to Christmas despite the huge demand for beautifully fashioned Jack-in-the-Boxes, spinning tops, walkable dogs, dolls, yo-yos and all sorts of toys. Cautiocus' attention to detail was considered impressive even for an elf.

He flipped the intercom switch on his desk. "Fry, I'm happy with the survey. Let's get it out!" The Workshop Safety Questionnaire was a vital part of Cautiocus' carefully layered procedures to make sure no elf had to spend the festive season nursing a sore thumb due to an overlooked unsafe working practice.

The elf paused again, thinking. The survey had a long URL, and the Lead Elves were very busy. He had already arranged free tickets for all respondents to a Yuletide performance with Bilbo Frostby, the North Pole's favourite crooner. Incentives were all very well, but he also had to make answering the survey as fritionless as possible. He flipped the switch again. "Fry, what was that article you were talking about?"

The Assistant Head's assistant entered holding the latest issue of I<Polar Web Monthly>. "Here you go, boss. It's called I<10 ways to boost online survey responses>." Cautiocus scanned the text; one of the sections caught his eye.

    5. Use a QR code for the survey link

    The folks you want to hear from have plenty to do already! Do they all have time to type in a long, cumbersome URL, especially on a portable device? Even if they do, what if they mistype it? Will they have the patience to try again, or will they conclude that they survey id down? If your survey link is longer than about 15 characters, or has any kind of numbers in it, let alone hex or a GUID, you'll be lucky to hear from anyone!

    Instead, use a 'QR code': a square design encoded with your weblink which respondents can scan with their mobile devices to take them straight to your questionnaire!

    Create a free QR code at:
    https://gr8.arcticinternet.northpole/qrcode

"This is it!" Cautiocus said. "Don't send the actual survey link out on the workshop order sheets. Hardly any elf got back to us last year because the SurveyFlunkey URL was hard to type. Use one of these instead!"

Fry generated a 'QR code' using the handy webapp mentioned in the magazine and uploaded it to the Central Workshop server so it could be added to the toy order lists sent out to all the elf workshops. Cautiocus checked the QR code one more time with his Elfone and smiled in quiet satisfaction, looking forward to the replies rolling in.

Fry brought up the survey dashboard on a large display on the wall of Cautiocus' office in the warm Safety Cabin so they could monitor the responses in real time. After returning with two mugs of cocoa, he was delighted to see that five responses had already rolled in.

=head2 The next day

Cautiocus entered the office the next morning. He stared at the display with concern. Still the same five responses! He summoned Fry, who tried refreshing the page. It came back just the same!

Feeling queasy, Cautiocus tested the QR code again. B<Calamity!>

Gr8 Arctic Internet apparently stood for 'Grinch Ate the Arctic Internet'.
His QR code now led to a page on I<their> website demanding I<all the toys bound for children in the Nordic countries> in order to reenable the survey link â€“ and suggesting they get coal instead!

This was an emergency. Cautiocus put his pointy hard hat on and called the IT Helpdesk. "We're sending down Tech Elf Tania now," he was advised.

=head2 Techie Tania whirls into action

Tania shot in 45 seconds later. "I hear you have a problem with your survey!"

Cautiocus glumly indicated the sample order sheet. Tania scanned it with her own Elfone. Up popped the Grinch's webpage, with his grisly green mien glowering out of it, eager to ruin Christmas for millions of children.

"What happened?!" cried Cautiocus. "Did that old rogue hack into our servers?"

"Well, no," Tania responded. "Did you get this QR code from an external provider?" 

"Yes... I thought they were called 'Great Arctic Internet'."

"There's the problem. By sweet-talking a local journalist or and masquerading as a respectable Arctic business, the Grinch has managed to persuade local elves, including you, to use his QR code generator. It never pointed to your survey, just to a GrinchNet URL that originally redirected to your survey, but now to something far less beneficent!"

"What can we do?"

"Well, the first thing is to generate a QR code to your actual survey. Fortunately I have just the Perl script! It uses the C<Imager::QRCode> distribution by Yoshiki Kurihara to output QR codes of various kinds. You can even choose the colours! Though, say, dark blue and purple together won't work very well, of course."

=begin perl

    #!/usr/bin/env perl

    use strict;
    use warnings;

    use Imager::QRCode;

    my $qrcode = Imager::QRCode->new(
        size          => 4,
        margin        => 1,
        version       => 1,
        level         => 'L',
        casesensitive => 1,
        lightcolor    => Imager::Color->new(255, 255, 255),
        darkcolor     => Imager::Color->new(0, 0, 0),
    );

    my $message = shift;

    die 'must provide message' unless $message;

    my $img = $qrcode->plot($message);

    $img->write(file => "qrcode_". time() . ".gif")
      or die "Failed to write: " . $img->errstr;

=end perl

Tania ran the script inputting the URL for Cautiocus' safety survey and a new QR code appeared.

She demonstrated that the survey opened up on her Elfone when scanning the new code. Cautiocus and Fry beamed!

"Well done, Techie Tania! But what about the old QR code?"

"That's a bit more difficult. But we can certainly configure our enterprise routers to redirect the GrinchNet URL back to your survey. That'll work for any device connected to the workshop WiFi. Not so much if they're outside, though."

Cautiocus was delighted. "That'll do. Merry Christmas, Tania."

"Merry Christmas."


